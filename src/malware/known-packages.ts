/**
 * Known malware packages database
 * Source: npm advisories, Snyk, Socket.dev reports
 */

// Packages that had confirmed malware at some point
// This is a subset - in production would use OSV/Snyk API
export const KNOWN_MALWARE_PACKAGES = new Set([
  // Famous supply chain attacks
  'event-stream',           // 2018 - Bitcoin wallet stealer
  'flatmap-stream',         // 2018 - event-stream dependency
  'ua-parser-js',           // 2021 - Cryptocurrency miner
  'coa',                    // 2021 - Compromised
  'rc',                     // 2021 - Compromised
  'colors',                 // 2022 - Intentional sabotage (AMERICAN FLAG)
  'faker',                  // 2022 - Intentional sabotage
  'node-ipc',               // 2022 - Protestware (peacenotwar)
  
  // Typosquatting attacks
  'crossenv',               // Typosquat of cross-env
  'cross-env.js',           // Typosquat of cross-env
  'mongose',                // Typosquat of mongoose
  'expresss',               // Typosquat of express
  'loadsh',                 // Typosquat of lodash
  'lodashs',                // Typosquat of lodash
  
  // Recent notable incidents
  'ethers-provider2',       // 2024 - Wallet drainer
  'ethers-providerz',       // 2024 - Wallet drainer
  '@pika/chalk',            // Malicious fork
  'chalk-next',             // Malicious fork
]);

/**
 * Check if a package has known malware history
 */
export function hasMalwareHistory(packageName: string): boolean {
  return KNOWN_MALWARE_PACKAGES.has(packageName.toLowerCase());
}

/**
 * Get malware details if known
 */
export function getMalwareDetails(packageName: string): string | null {
  const details: Record<string, string> = {
    'event-stream': 'Bitcoin wallet stealer (2018)',
    'ua-parser-js': 'Cryptocurrency miner injection (2021)',
    'colors': 'Intentional sabotage - infinite loop (2022)',
    'faker': 'Intentional sabotage (2022)',
    'node-ipc': 'Protestware - peacenotwar (2022)',
  };
  return details[packageName.toLowerCase()] || null;
}
